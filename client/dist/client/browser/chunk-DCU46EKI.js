import{a as We,c as je,f as Ke,h as Ge,i as Ye,l as qe,m as Xe}from"./chunk-PMHQJODB.js";import{a as Re}from"./chunk-E6VCRUKE.js";import{C as Be,D as ze,E as $e,n as S,o as Ne,p as k,q as ie,u as He,w as Le,y as ue}from"./chunk-35D7H6KK.js";import{$ as ke,Ba as b,Ca as I,Da as L,H as pe,Ha as E,I as Te,Ia as B,Ja as Fe,R as w,Ra as q,S as Ee,Ta as X,Ua as Z,V as G,Va as J,W as m,Wa as Q,X as d,Xa as z,Ya as $,Za as ee,_ as h,_a as te,a as we,ab as ne,b as Me,ba as De,ca as D,da as Ve,ea as a,fa as P,fb as Ae,gb as oe,ha as C,hb as Ue,ia as g,j as be,ja as f,l as de,la as A,m as Oe,ma as U,n as Se,na as r,oa as s,p as ye,pa as x,qa as _,ra as p,sa as c,t as Ie,ta as R,ua as N,va as u,wa as T,xa as Y,ya as H,za as M}from"./chunk-AUYOIWGM.js";function mt(t,n,e,o){let i=window&&!!window.document&&window.document.documentElement,l=i&&n?window:e;if(t&&(l=t&&i&&typeof t=="string"?dt(t,e.nativeElement,o):t,!l))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return l}function dt(t,n,e){return(e?window.document:n).querySelector(t)}function fe(t){return t&&!t.firstChange}function pt(){return typeof window<"u"}var ut={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},ft={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},_e=class{constructor(n=!0){this.vertical=n,this.propsMap=n?ut:ft}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function _t(t,n,e){return!!(t&&n||!e&&n)}function Ct({windowElement:t,axis:n}){return gt({axis:n,isWindow:ht(t)},t)}function gt(t,n){let e=t.isWindow||n&&!n.nativeElement?n:n.nativeElement;return Me(we({},t),{container:e})}function ht(t){return["Window","global"].some(e=>Object.prototype.toString.call(t).includes(e))}function he(t,n){return t?n.document.documentElement:null}function Ze(t,n){let e=vt(n);return n.isWindow?Pt(e,t,n):xt(e,t,n)}function Pt(t,n,e){let{axis:o,container:i,isWindow:l}=e,{offsetHeightKey:v,clientHeightKey:y}=Je(o),F=t+et(he(l,i),o,l),O=Qe(n.nativeElement,l,v,y),K=wt(n.nativeElement,o,l)+O;return{height:t,scrolled:F,totalToScroll:K,isWindow:l}}function xt(t,n,e){let{axis:o,container:i}=e,l=i[o.scrollTopKey()],v=i[o.scrollHeightKey()];return{height:t,scrolled:l,totalToScroll:v,isWindow:!1}}function Je(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function vt({container:t,isWindow:n,axis:e}){let{offsetHeightKey:o,clientHeightKey:i}=Je(e);return Qe(t,n,o,i)}function Qe(t,n,e,o){if(isNaN(t[e])){let i=he(n,t);return i?i[o]:0}else return t[e]}function wt(t,n,e){let o=n.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[o]+et(t,n,e)}function et(t,n,e){let o=n.pageYOffsetKey(),i=n.scrollTopKey(),l=n.offsetTopKey();return isNaN(window.pageYOffset)?he(e,t)[i]:t.ownerDocument?t.ownerDocument.defaultView[o]:t[l]}function Mt(t,n={down:0,up:0},e){let o,i;if(t.totalToScroll<=0)return!1;let l=t.isWindow?t.scrolled:t.height+t.scrolled;if(e)o=(t.totalToScroll-l)/t.totalToScroll,i=(n?.down?n.down:0)/10;else{let y=t.scrolled+(t.totalToScroll-l);o=t.scrolled/y,i=(n?.up?n.up:0)/10}return o<=i}function bt(t,n){return t<n.scrolled}function Ot(t,n,e){let o=bt(t,n);return{fire:Mt(n,e,o),scrollDown:o}}var Ce=class{constructor(n){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,n)}updateScrollPosition(n){return this.lastScrollPosition=n}updateTotalToScroll(n){this.lastTotalToScroll!==n&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=n)}updateScroll(n,e){this.updateScrollPosition(n),this.updateTotalToScroll(e)}updateTriggeredFlag(n,e){e?this.triggered.down=n:this.triggered.up=n}isTriggeredScroll(n,e){return e?this.triggered.down===n:this.triggered.up===n}};function St(t){let{scrollContainer:n,scrollWindow:e,element:o,fromRoot:i}=t,l=Ct({axis:new _e(!t.horizontal),windowElement:mt(n,e,o,i)}),v=new Ce({totalToScroll:Ze(o,l).totalToScroll}),y={container:l.container,throttle:t.throttle},F={up:t.upDistance,down:t.downDistance};return yt(y).pipe(Oe(()=>be(Ze(o,l))),de(O=>It(v.lastScrollPosition,O,F)),pe(({stats:O})=>v.updateScroll(O.scrolled,O.totalToScroll)),ye(({fire:O,scrollDown:K,stats:{totalToScroll:at}})=>_t(t.alwaysCallback,O,v.isTriggeredScroll(at,K))),pe(({scrollDown:O,stats:{totalToScroll:K}})=>{v.updateTriggeredFlag(K,O)}),de(Tt))}function yt(t){let n=Se(t.container,"scroll");return t.throttle&&(n=n.pipe(Te(t.throttle,void 0,{leading:!0,trailing:!0}))),n}function It(t,n,e){let{scrollDown:o,fire:i}=Ot(t,n,e);return{scrollDown:o,fire:i,stats:n}}var ge={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function Tt(t){let{scrollDown:n,stats:{scrolled:e}}=t;return{type:n?ge.DOWN:ge.UP,payload:{currentScrollPosition:e}}}var tt=(()=>{class t{constructor(e,o){this.element=e,this.zone=o,this.scrolled=new h,this.scrolledUp=new h,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:e,infiniteScrollDisabled:o,infiniteScrollDistance:i}){let l=fe(e),v=fe(o),y=fe(i),F=!v&&!this.infiniteScrollDisabled||v&&!o.currentValue||y;(l||v||y)&&(this.destroyScroller(),F&&this.setup())}ngOnDestroy(){this.destroyScroller()}setup(){pt()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=St({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(e=>this.handleOnScroll(e))})}handleOnScroll({type:e,payload:o}){let i=e===ge.DOWN?this.scrolled:this.scrolledUp;Et(i)&&this.zone.run(()=>i.emit(o))}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}static{this.\u0275fac=function(o){return new(o||t)(P(De),P(ke))}}static{this.\u0275dir=Ee({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},standalone:!0,features:[G]})}}return t})();function Et(t){return t.observed??t.observers.length>0}function kt(t,n){if(t&1){let e=_();r(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),p("click",function(){m(e);let i=c();return d(i.close())}),u(4,"x"),s(),r(5,"p"),u(6,"Are you sure you want to delete this post?"),s(),r(7,"div",4)(8,"a",5),p("click",function(){m(e);let i=c();return d(i.del())}),u(9,"Yes"),s(),r(10,"a",5),p("click",function(){m(e);let i=c();return d(i.close())}),u(11,"No"),s()()()()()}}var re=class t{showModal;closed=new h;delTrue=new h;ngOnChanges(n){n.showModal}close(){this.closed.emit()}del(){this.delTrue.emit()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=w({type:t,selectors:[["app-delete-modal"]],inputs:{showModal:"showModal"},outputs:{closed:"closed",delTrue:"delTrue"},standalone:!0,features:[G,M],decls:1,vars:1,consts:[[1,"modal-overlay"],[1,"modal-container"],[1,"options"],[1,"cross",3,"click"],[1,"btns"],[3,"click"]],template:function(e,o){e&1&&C(0,kt,12,0,"div",0),e&2&&f(o.showModal?0:-1)},styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-container[_ngcontent-%COMP%]{position:absolute;max-width:800px;top:30em;right:30em;background:#272727;border:1px solid #fff;border-radius:1em;padding:1.5em}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2em}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-size:2em}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]{display:flex;align-self:flex-end;max-width:30px;cursor:pointer}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]:hover{color:#03495a}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{display:flex;gap:1em}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border:1px solid #fff;border-radius:1em;padding:.5em 1em;font-size:1.2em;color:#fff;cursor:pointer}.modal-container[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#03495a}"]})};var Pe=ie("posts"),nt=k(Pe,t=>t.posts),ot=k(Pe,t=>t.loading),it=t=>k(Pe,n=>n.posts.find(e=>e._id===t));function Vt(t,n){if(t&1&&x(0,"img",6),t&2){let e=c();R("src",e.postPic,D)}}function Ft(t,n){if(t&1&&x(0,"img",6),t&2){let e=c(2);g("src",e.previewUrl,D)}}function At(t,n){if(t&1){let e=_();r(0,"div",1)(1,"p",2),p("click",function(){m(e);let i=c();return d(i.close())}),u(2,"x"),s(),r(3,"div",3)(4,"div",4)(5,"a",5),x(6,"img",6),s()(),r(7,"div",7)(8,"a",5)(9,"h2"),u(10),s()(),r(11,"p"),u(12),b(13,"date"),s()()(),r(14,"form",8),p("ngSubmit",function(){m(e);let i=c();return d(i.onSubmit())}),r(15,"div",9),x(16,"textarea",10),s(),r(17,"div",11),C(18,Vt,1,1,"img",6)(19,Ft,1,1,"img",6),r(20,"input",12),p("change",function(i){m(e);let l=c();return d(l.onFileSelected(i))}),s()(),r(21,"button",13),u(22,"Save"),s()()()}if(t&2){let e=n,o=c();a(5),N("routerLink","/user/profile/",e.owner._id,""),a(),R("src",e.owner.profilePic,D),a(2),N("routerLink","/user/profile/",e.owner._id,""),a(2),H("",e.owner.firstName," ",e.owner.lastName,""),a(2),T(L(13,11,e.createdAt,"dd.MM.yyyy, HH:mm")),a(2),g("formGroup",o.postForm),a(4),f(o.previewUrl?19:18),a(3),g("disabled",o.postForm.invalid)}}var se=class t{constructor(n,e){this.fb=n;this.store=e}postId;closed=new h;postForm;selectedFile;previewUrl=null;currentImage;post$;ngOnInit(){this.post$=this.store.pipe(Ne(it(this.postId))),this.postForm=new z({description:new $("",[Z.required])}),this.post$.pipe(Ie(1)).subscribe(n=>{n&&(this.postForm.patchValue({description:n.description}),this.currentImage=n.postPic)})}onFileSelected(n){let e=n.target.files?.[0];if(e){this.selectedFile=e;let o=new FileReader;o.onload=()=>this.previewUrl=o.result,o.readAsDataURL(e)}}onSubmit(){if(this.postForm.invalid)return;let{description:n}=this.postForm.value;this.selectedFile?this.store.dispatch(ue({file:this.selectedFile,description:n,postId:this.postId})):this.store.dispatch(ue({file:this.currentImage,description:n,postId:this.postId}))}close(){this.closed.emit()}static \u0275fac=function(e){return new(e||t)(P(Ae),P(S))};static \u0275cmp=w({type:t,selectors:[["app-edit-post"]],inputs:{postId:"postId"},outputs:{closed:"closed"},standalone:!0,features:[M],decls:4,vars:3,consts:[[1,"container"],[1,"post-card"],[1,"cross",3,"click"],[1,"author"],[1,"author-pic"],[3,"routerLink"],["alt","",3,"src"],[1,"author-info"],[3,"ngSubmit","formGroup"],[1,"description"],["formControlName","description",1,"form-group"],[1,"media"],["type","file",3,"change"],[3,"disabled"]],template:function(e,o){if(e&1&&(r(0,"section")(1,"div",0),C(2,At,23,14,"div",1),b(3,"async"),s()()),e&2){let i;a(2),f((i=I(3,1,o.post$))?2:-1,i)}},dependencies:[q,oe,ee,X,J,Q,te,ne,E,B],styles:["section[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000}img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.cross[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;text-transform:uppercase;color:#fff}.cross[_ngcontent-%COMP%]:hover{cursor:pointer}.post-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:2em 0;padding:1em;gap:.8em;background:#272727;border-radius:2em;min-height:600px}.post-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:relative;display:inline-block;margin-left:28em;cursor:pointer}.post-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-size:2.5em}.post-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:block;position:absolute;top:25px;right:0;background-color:#333;border-radius:.5em;padding:1em;box-shadow:0 8px 16px #0003;z-index:1}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:.6em;color:#fff;text-decoration:none}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#555}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{display:flex;gap:1em}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-pic[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80px;border-radius:50%;aspect-ratio:1;cursor:pointer}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:.5em}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{cursor:pointer}.description[_ngcontent-%COMP%]{margin-bottom:1em}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .post-card[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.post-card[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.7em}textarea[_ngcontent-%COMP%]{resize:none;width:100%;height:100px;background:#272727;outline:none;border-radius:1em;padding:1em;color:#fff}.media[_ngcontent-%COMP%]{max-width:800px;border:1px solid gray;padding:1em;border-radius:1em}.media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}button[_ngcontent-%COMP%]{margin-top:1em;background:transparent;padding:.5em 1em;border-radius:2em;border:1px solid #fff;color:#fff;cursor:pointer}.post-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#444;cursor:not-allowed}.media[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]{display:block;margin-top:10px;padding:8px;font-size:14px;background-color:#f4f4f4;border:2px solid #ccc;border-radius:4px;cursor:pointer}.media[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.media[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#007bff;color:#fff;border-radius:4px;cursor:pointer}.media[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}"]})};var xe=ie("comments"),st=k(xe,t=>t.comments),Wn=k(xe,t=>t.loading),lt=t=>k(xe,n=>n.comments.find(e=>e._id===t)?.showReplies||[]);var ve=(e=>(e.replying="replying",e.editing="editing",e))(ve||{});var j=class t{submitLabel;hasCancelButton=!1;initialText="";handleSubmit=new h;handleCancel=new h;form;constructor(){}ngOnInit(){this.form=new z({title:new $(this.initialText,[Z.required])})}onSubmit(){this.handleSubmit.emit(this.form.value.title),this.form.reset()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=w({type:t,selectors:[["app-comment-form"]],inputs:{submitLabel:"submitLabel",hasCancelButton:"hasCancelButton",initialText:"initialText"},outputs:{handleSubmit:"handleSubmit",handleCancel:"handleCancel"},standalone:!0,features:[M],decls:6,vars:3,consts:[[3,"ngSubmit","formGroup"],["formControlName","title",1,"comment-form-textarea"],["type","submit",1,"comment-form-button",3,"disabled"]],template:function(e,o){e&1&&(r(0,"form",0),p("ngSubmit",function(){return o.onSubmit()}),r(1,"h5"),u(2,"Leave Comment"),s(),x(3,"textarea",1),r(4,"button",2),u(5),s()()),e&2&&(g("formGroup",o.form),a(4),g("disabled",o.form.invalid),a(),Y(" ",o.submitLabel," "))},dependencies:[oe,ee,X,J,Q,te,ne],styles:["h5[_ngcontent-%COMP%]{color:#fff;font-size:1em;font-weight:400;margin-bottom:.5em}.comment-form-textarea[_ngcontent-%COMP%]{width:100%;font-size:1em;padding:1em;background:#272727;border-radius:1em;outline:none;color:#fff;overflow:hidden;resize:none}.comment-form-button[_ngcontent-%COMP%]{width:10%;margin-top:1.2em;align-self:self-end;padding:.4em;background:transparent;color:#fff;border:1px solid #fff;border-radius:1.2em;cursor:pointer;outline:none}.comment-form-button[_ngcontent-%COMP%]:hover:enabled{cursor:pointer;background:#03495a}.comment-form-button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}"]})};var Ut=(t,n)=>n._id;function Rt(t,n){if(t&1){let e=_();r(0,"div",14),p("click",function(){m(e);let i=c();return d(i.setActiveComment.emit({id:i.comment._id,type:i.activeCommentType.editing}))}),u(1,"edit"),s()}}function Nt(t,n){if(t&1){let e=_();r(0,"div",15),p("click",function(){m(e);let i=c();return d(i.deleteComment.emit({commentId:i.comment._id,parentId:i.comment.parentId}))}),u(1,"delete "),s()}}function Ht(t,n){if(t&1){let e=_();r(0,"div",16),p("click",function(){m(e);let i=c();return d(i.setActiveComment.emit({id:i.comment._id,type:i.activeCommentType.replying}))}),u(1,"reply"),s()}}function Lt(t,n){if(t&1){let e=_();r(0,"div",9)(1,"p",17),p("click",function(){m(e);let i=c();return d(i.toggleReplies(i.comment._id))}),u(2),s()()}if(t&2){let e=c();a(2),T(e.comment.replies.length===1?"This comment has 1 reply":"This comment has "+e.comment.replies.length+" replies")}}function Bt(t,n){if(t&1){let e=_();r(0,"app-comment",19),p("setActiveComment",function(i){m(e);let l=c(3);return d(l.setActiveComment.emit(i))})("updateComment",function(i){m(e);let l=c(3);return d(l.updateComment.emit(i))})("deleteComment",function(i){m(e);let l=c(3);return d(l.deleteComment.emit(i))})("addComment",function(i){m(e);let l=c(3);return d(l.addComment.emit(i))}),s()}if(t&2){let e=n.$implicit,o=c(3);g("comment",e)("activeComment",o.activeComment)("parentId",o.comment._id)("currentUserId",o.currentUserId)}}function zt(t,n){t&1&&A(0,Bt,1,4,"app-comment",18,Ut),t&2&&U(n)}function $t(t,n){if(t&1&&(r(0,"div",10),C(1,zt,2,0),b(2,"async"),s()),t&2){let e,o=c();a(),f((e=I(2,1,o.replies$))?1:-1,e)}}function Wt(t,n){if(t&1){let e=_();r(0,"app-comment-form",20),p("handleSubmit",function(i){m(e);let l=c();return d(l.updateComment.emit({text:i,commentId:l.comment._id}))})("handleCancel",function(){m(e);let i=c();return d(i.setActiveComment.emit(null))}),s()}if(t&2){let e=c();g("hasCancelButton",!0)("initialText",e.comment.comment)}}function jt(t,n){if(t&1){let e=_();r(0,"app-comment-form",21),p("handleCancel",function(){m(e);let i=c();return d(i.setActiveComment.emit(null))})("handleSubmit",function(i){m(e);let l=c();return d(l.addComment.emit({text:i,parentId:l.replyId}))}),s()}t&2&&g("hasCancelButton",!0)}var ce=class t{constructor(n){this.store=n}comment;currentUserId;activeComment;parentId;replies$;setActiveComment=new h;getReplies=new h;addComment=new h;deleteComment=new h;updateComment=new h;canEdit=!1;canDelete=!1;canReply=!1;showReplies=!1;replyId;activeCommentType=ve;ngOnInit(){this.canEdit=this.currentUserId===this.comment.userId,this.canDelete=this.currentUserId===this.comment.userId,this.canReply=!!this.currentUserId,this.replyId=this.parentId?this.parentId:this.comment._id}isShown(){this.showReplies=!this.showReplies}isReplying(){return this.activeComment?this.activeComment.id===this.comment._id&&this.activeComment.type===this.activeCommentType.replying:!1}isEditing(){return this.activeComment?this.activeComment.id===this.comment._id&&this.activeComment.type===this.activeCommentType.editing:!1}toggleReplies(n){this.showReplies||this.getReplies.emit(n),this.showReplies=!this.showReplies}static \u0275fac=function(e){return new(e||t)(P(S))};static \u0275cmp=w({type:t,selectors:[["app-comment"]],inputs:{comment:"comment",currentUserId:"currentUserId",activeComment:"activeComment",parentId:"parentId",replies$:"replies$"},outputs:{setActiveComment:"setActiveComment",getReplies:"getReplies",addComment:"addComment",deleteComment:"deleteComment",updateComment:"updateComment"},standalone:!0,features:[M],decls:18,vars:13,consts:[[1,"showComments"],[1,"comment"],[1,"separator"],[1,"date"],[1,"createdAt"],[1,"comment-btns"],[1,"edit-btn"],[1,"delete-btn"],[1,"reply-btn"],[1,"replies"],[1,"show-replies"],[1,"comment-btn"],["submitLabel","Update",3,"hasCancelButton","initialText"],["submitLabel","Reply",3,"hasCancelButton"],[1,"edit-btn",3,"click"],[1,"delete-btn",3,"click"],[1,"reply-btn",3,"click"],[3,"click"],[3,"comment","activeComment","parentId","currentUserId"],[3,"setActiveComment","updateComment","deleteComment","addComment","comment","activeComment","parentId","currentUserId"],["submitLabel","Update",3,"handleSubmit","handleCancel","hasCancelButton","initialText"],["submitLabel","Reply",3,"handleCancel","handleSubmit","hasCancelButton"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"p"),u(3),s()(),r(4,"div",2)(5,"div",3)(6,"p",4),u(7),b(8,"date"),s()(),r(9,"div",5),C(10,Rt,2,0,"div",6)(11,Nt,2,0,"div",7)(12,Ht,2,0,"div",8),s()(),C(13,Lt,3,1,"div",9)(14,$t,3,3,"div",10),s(),r(15,"div",11),C(16,Wt,1,2,"app-comment-form",12)(17,jt,1,1,"app-comment-form",13),s()),e&2&&(a(3),H("",o.comment.username,": ",o.comment.comment,""),a(4),T(L(8,10,o.comment.createdAt,"dd.MM.yyyy, HH:mm")),a(3),f(o.canEdit?10:-1),a(),f(o.canDelete?11:-1),a(),f(o.canReply?12:-1),a(),f(!o.showReplies&&o.comment.replies.length>0?13:-1),a(),f(o.showReplies?14:-1),a(2),f(o.isEditing()?16:-1),a(),f(o.isReplying()?17:-1))},dependencies:[t,j,E,B],styles:[".showComments[_ngcontent-%COMP%]{max-width:1000px;display:flex;flex-direction:column;margin-bottom:.5em}.comment[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid rgb(213,206,206);border-radius:.5em;padding:1em;margin-top:.5em}.separator[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:space-between;margin-top:.5em}.createdAt[_ngcontent-%COMP%]{display:block;align-self:flex-end;align-items:center;font-size:.8em;margin-top:.5em;width:110px}.showComments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.comment-btns[_ngcontent-%COMP%]{display:flex;max-width:180px;align-items:center;gap:2em;color:#aaa6a6}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%], .reply-btn[_ngcontent-%COMP%]:hover{cursor:pointer}.replies[_ngcontent-%COMP%]{display:flex;margin-top:.5em}.replies[_ngcontent-%COMP%]:hover{cursor:pointer}.show-replies[_ngcontent-%COMP%]{margin-left:1em}"]})};var Kt=(t,n)=>n._id;function Gt(t,n){if(t&1){let e=_();r(0,"app-comment",6),p("updateComment",function(i){m(e);let l=c(2);return d(l.updateComment(i))})("setActiveComment",function(i){m(e);let l=c(2);return d(l.setActiveComment(i))})("addComment",function(i){m(e);let l=c(2);return d(l.addComment(i))})("deleteComment",function(i){m(e);let l=c(2);return d(l.deleteComment(i))})("getReplies",function(i){m(e);let l=c(2);return d(l.getReplies(i))}),s()}if(t&2){let e=n.$implicit,o=c(2);g("comment",e)("currentUserId",o.userId)("activeComment",o.activeComment)("replies$",o.replies$)}}function Yt(t,n){t&1&&A(0,Gt,1,4,"app-comment",5,Kt),t&2&&U(n)}var ae=class t{constructor(n){this.store=n}postId;closed=new h;userId;username;comments$;commentForm;replies$;activeComment=null;ngOnInit(){this.commentForm=new z({comment:new $("")}),this.comments$=this.store.select(st),this.store.dispatch(We({postId:this.postId}))}setActiveComment(n){this.activeComment=n}closeComments(){this.closed.emit()}addComment({text:n,parentId:e}){this.store.dispatch(je({text:n,userId:this.userId,username:this.username,postId:this.postId,parentId:e})),this.activeComment=null}updateComment({commentId:n,text:e}){this.store.dispatch(Ye({commentId:n,comment:e})),this.activeComment=null}deleteComment({commentId:n,parentId:e}){e?this.store.dispatch(qe({parentId:e,replyId:n,postId:this.postId})):this.store.dispatch(Ge({commentId:n,postId:this.postId}))}getReplies(n){this.store.dispatch(Ke({parentId:n})),this.replies$=this.store.select(lt(n))}static \u0275fac=function(e){return new(e||t)(P(S))};static \u0275cmp=w({type:t,selectors:[["app-comments"]],inputs:{postId:"postId",userId:"userId",username:"username"},outputs:{closed:"closed"},standalone:!0,features:[M],decls:8,vars:3,consts:[[1,"comment"],[1,"comments"],[1,"cross",3,"click"],[1,"comments-container"],["submitLabel","Write",3,"handleSubmit"],[3,"comment","currentUserId","activeComment","replies$"],[3,"updateComment","setActiveComment","addComment","deleteComment","getReplies","comment","currentUserId","activeComment","replies$"]],template:function(e,o){if(e&1&&(r(0,"section",0)(1,"div",1)(2,"p",2),p("click",function(){return o.closeComments()}),u(3,"x"),s(),r(4,"div",3),C(5,Yt,2,0),b(6,"async"),s(),r(7,"app-comment-form",4),p("handleSubmit",function(l){return o.addComment({text:l,parentId:null})}),s()()()),e&2){let i;a(5),f((i=I(6,1,o.comments$))?5:-1,i)}},dependencies:[ce,j,E],styles:[".comment[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000}.comments[_ngcontent-%COMP%]{width:800px;background:#272727;border:1px solid #fff;border-radius:1em;padding:1.5em}.comments[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]{display:block;justify-self:end;max-width:15px;margin-bottom:10px;text-transform:uppercase;color:#fff}.comments[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]:hover{cursor:pointer;color:#03495a}"]})};function qt(t,n){if(t&1){let e=_();r(0,"app-delete-modal",16),p("closed",function(){m(e);let i=c();return d(i.onModalClosed())})("delTrue",function(){m(e);let i=c();return d(i.onDelPostConfirmed())}),s()}if(t&2){let e=c();g("showModal",e.showModal)}}function Xt(t,n){if(t&1){let e=_();r(0,"app-edit-post",17),p("closed",function(){m(e);let i=c();return d(i.onEditClosed())}),s()}if(t&2){let e=c();g("postId",e.post._id)}}function Zt(t,n){if(t&1){let e=_();r(0,"div",18)(1,"ul")(2,"li"),x(3,"i",19),r(4,"a",14),p("click",function(){m(e);let i=c(2);return d(i.toggleEdit())}),u(5,"Edit"),s()(),r(6,"li"),x(7,"i",20),r(8,"a",14),p("click",function(){m(e);let i=c(2);return d(i.openDeleteModal(i.post._id))}),u(9,"Delete"),s()()()()}}function Jt(t,n){if(t&1){let e=_();r(0,"div",9)(1,"p",14),p("click",function(){m(e);let i=c();return d(i.toggleDropdown(i.post._id))}),u(2,"..."),s(),C(3,Zt,10,0,"div",18),s()}if(t&2){let e=c();a(3),f(e.activeDropdown===e.post._id?3:-1)}}function Qt(t,n){if(t&1){let e=_();r(0,"a",14),p("click",function(){m(e);let i=c();return d(i.like(i.post._id))}),u(1,"Like"),s()}}function en(t,n){if(t&1){let e=_();r(0,"a",14),p("click",function(){m(e);let i=c();return d(i.unlike(i.post._id))}),u(1,"Unlike"),s()}}function tn(t,n){if(t&1){let e=_();r(0,"app-comments",21),p("closed",function(){m(e);let i=c();return d(i.onCommenteClosed())}),s()}if(t&2){let e=c();g("postId",e.post._id)("userId",e.currentUserId)("username",e.currentUsername)}}var me=class t{constructor(n,e,o){this.postService=n;this.userService=e;this.store=o}post;activeDropdown=null;showModal=!1;isDel=!1;activePostId=null;activeComment=null;showComments=!1;canEdit=!1;likeBtn=!1;get currentUsername(){return this.userService.currentUsername}get currentUserId(){return this.userService.currentUserId}openDeleteModal(n){this.showModal=!0,this.activePostId=n}onModalClosed(){this.showModal=!1,this.activePostId=null}onDelPostConfirmed(){this.activePostId&&this.store.dispatch(Be({id:this.activePostId,userId:this.currentUserId})),this.showModal=!1,this.activePostId=null}toggleDropdown(n){this.activeDropdown=this.activeDropdown===n?null:n}toggleEdit(){this.canEdit=!this.canEdit}onEditClosed(){this.canEdit=!1}toggleComments(n){this.activeComment=this.activeComment===n?null:n}onCommenteClosed(){this.activeComment=null}like(n){this.store.dispatch(ze({postId:n,userId:this.currentUserId}))}unlike(n){this.store.dispatch($e({postId:n,userId:this.currentUserId}))}isLiked(n){return n?.likes.includes(this.currentUserId)}isCreator(n){return n?.owner._id.includes(this.currentUserId)}onDocumentClick(n){n.target.closest(".dropdown-menu")||(this.activeDropdown=null)}static \u0275fac=function(e){return new(e||t)(P(Xe),P(Ue),P(S))};static \u0275cmp=w({type:t,selectors:[["app-post-item"]],hostBindings:function(e,o){e&1&&p("click",function(l){return o.onDocumentClick(l)},!1,Ve)},inputs:{post:"post"},standalone:!0,features:[M],decls:30,vars:20,consts:[[3,"showModal"],[3,"postId"],[1,"container"],[1,"post-card"],[1,"author"],[1,"author-pic"],[3,"routerLink"],["alt","",3,"src"],[1,"author-info"],[1,"dropdown-menu"],[1,"description"],[1,"media"],[1,"count"],[1,"post-btns"],[3,"click"],[3,"postId","userId","username"],[3,"closed","delTrue","showModal"],[3,"closed","postId"],[1,"options"],[1,"fa-regular","fa-pen-to-square"],[1,"fa-solid","fa-trash"],[3,"closed","postId","userId","username"]],template:function(e,o){e&1&&(C(0,qt,1,1,"app-delete-modal",0)(1,Xt,1,1,"app-edit-post",1),r(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"a",6),x(7,"img",7),s()(),r(8,"div",8)(9,"a",6)(10,"h2"),u(11),s()(),r(12,"p"),u(13),b(14,"date"),s()(),C(15,Jt,4,1,"div",9),s(),r(16,"div",10)(17,"p"),u(18),s()(),r(19,"div",11),x(20,"img",7),s(),r(21,"div",12)(22,"p"),u(23),s()(),r(24,"div",13),C(25,Qt,2,0,"a")(26,en,2,0,"a"),r(27,"a",14),p("click",function(){return o.toggleComments(o.post._id)}),u(28,"comment"),s(),C(29,tn,1,3,"app-comments",15),s()()()),e&2&&(f(o.showModal?0:-1),a(),f(o.canEdit?1:-1),a(5),N("routerLink","/user/profile/",o.post.owner._id,""),a(),R("src",o.post.owner.profilePic,D),a(2),N("routerLink","/user/profile/",o.post.owner._id,""),a(2),H("",o.post.owner.firstName," ",o.post.owner.lastName,""),a(2),T(L(14,17,o.post.createdAt,"dd.MM.yyyy, HH:mm")),a(2),f(o.post.owner._id===o.currentUserId?15:-1),a(3),T(o.post.description),a(2),R("src",o.post.postPic,D),a(3),Y("",o.post.likes.length," \u0445\u0430\u0440\u0435\u0441\u0432\u0430\u043D\u0438\u044F"),a(2),f(!o.isLiked(o.post)&&!o.isCreator(o.post)?25:-1),a(),f(o.isLiked(o.post)&&!o.isCreator(o.post)?26:-1),a(3),f(o.activeComment===o.post._id?29:-1))},dependencies:[re,se,B,q,ae],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.post-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:2em 0;padding:1em;gap:.8em;background:#272727;border-radius:2em;min-height:600px}.post-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:relative;display:inline-block;margin-left:28em;cursor:pointer}.post-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-size:2.5em}.post-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:block;position:absolute;top:25px;right:0;background-color:#333;border-radius:.5em;padding:1.2em;box-shadow:0 8px 16px #0003;z-index:1}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-direction:column;list-style:none;padding:0;margin:0}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:.8em;color:#fff;text-decoration:none}.options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{border-radius:.5em;background-color:#555}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{display:flex;gap:1em}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-pic[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80px;border-radius:50%;aspect-ratio:1;cursor:pointer}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:.5em}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{cursor:pointer}.post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .post-card[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .author-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .post-card[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.post-card[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.7em}.media[_ngcontent-%COMP%]{max-width:800px;border:1px solid gray;padding:1em;border-radius:1em}.media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:auto}.count[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.count[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.post-btns[_ngcontent-%COMP%]{display:flex;gap:1.5em;border-top:1px solid rgb(83,79,79);padding:.5em}.post-btns[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-top:1em;padding:.5em 1em;border:2px solid #fff;color:#fff;border-radius:1em;cursor:pointer}"]})};var nn=(t,n)=>n._id;function on(t,n){if(t&1&&x(0,"app-post-item",3),t&2){let e=n.$implicit;g("post",e)}}function rn(t,n){t&1&&A(0,on,1,1,"app-post-item",3,nn),t&2&&U(n)}function sn(t,n){if(t&1){let e=_();r(0,"div",1),p("scrolled",function(){m(e);let i=c();return d(i.onScroll())}),r(1,"section",2),C(2,rn,2,0),b(3,"async"),s()()}if(t&2){let e,o=c();g("infiniteScrollDistance",2)("infiniteScrollThrottle",50),a(2),f((e=I(3,3,o.posts$))?2:-1,e)}}function ln(t,n){t&1&&x(0,"app-loader")}var ct=class t{constructor(n){this.store=n;this.posts$=this.store.select(nt),this.loader$=this.store.select(ot)}posts$;loading=!1;loader$;page=1;ngOnInit(){this.store.dispatch(He())}onScroll(){this.page++,this.store.dispatch(Le({num:this.page}))}static \u0275fac=function(e){return new(e||t)(P(S))};static \u0275cmp=w({type:t,selectors:[["app-posts"]],standalone:!0,features:[M],decls:3,vars:3,consts:[["infinite-scroll","",1,"search-results",3,"infiniteScrollDistance","infiniteScrollThrottle"],["infinite-scroll","",1,"search-results",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle"],[1,"posts-page"],[3,"post"]],template:function(e,o){e&1&&(C(0,sn,4,5,"div",0),b(1,"async"),C(2,ln,1,0,"app-loader")),e&2&&f(I(1,1,o.loader$)?0:2)},dependencies:[me,E,Fe,Re,tt]})};export{ct as PostsComponent};
